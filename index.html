<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Safety Strategic Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: #2d3748;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.7;
            color: #718096;
        }

        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: white;
            border-radius: 20px;
            padding: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border: 1px solid #e2e8f0;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 30px;
        }

        .tab-button {
            flex: 1;
            padding: 12px 24px;
            border: none;
            background: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #718096;
        }

        .tab-button.active {
            background: #10b981;
            color: white;
            box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.25);
        }

        .tab-button:hover:not(.active) {
            background: #f7fafc;
            color: #4a5568;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .panel {
            background: white;
            border-radius: 24px;
            padding: 32px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border: 1px solid #e2e8f0;
        }

        .input-section h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
            appearance: none;
        }

        select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 12px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 40px;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 16px 24px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
        }

        .btn:hover {
            background: #059669;
            transform: translateY(-1px);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.25);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .results-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .risk-heatmap {
            background: white;
            border-radius: 24px;
            padding: 32px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border: 1px solid #e2e8f0;
        }

        .heatmap-title {
            font-size: 1.4rem;
            color: #2d3748;
            margin-bottom: 20px;
            text-align: center;
        }

        .risk-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .risk-cell {
            background: white;
            border-radius: 20px;
            padding: 24px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .risk-cell:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            border-color: #cbd5e0;
        }

        .risk-critical {
            border-left: 4px solid #ef4444;
        }

        .risk-high {
            border-left: 4px solid #f97316;
        }

        .risk-medium {
            border-left: 4px solid #eab308;
        }

        .risk-low {
            border-left: 4px solid #22c55e;
        }

        .risk-cell h3 {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: #2d3748;
        }

        .risk-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .paper-count {
            background: rgba(0,0,0,0.1);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .risk-level {
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .risk-critical .risk-level { color: #ef4444; }
        .risk-high .risk-level { color: #f97316; }
        .risk-medium .risk-level { color: #eab308; }
        .risk-low .risk-level { color: #22c55e; }

        .priority-score {
            background: #10b981;
            color: white;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }

        .summary-card {
            background: white;
            padding: 24px;
            border-radius: 20px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border: 1px solid #e2e8f0;
            min-height: 200px;
            display: flex;
            flex-direction: column;
        }

        .summary-card h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .summary-list {
            list-style: none;
            flex: 1;
        }

        .summary-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            color: #4a5568;
            font-size: 0.85rem;
            line-height: 1.4;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .summary-list li:last-child {
            border-bottom: none;
        }

        .priority-badge {
            background: #10b981;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 8px;
            white-space: nowrap;
            display: inline-block;
        }

        .papers-section {
            background: white;
            border-radius: 24px;
            padding: 32px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border: 1px solid #e2e8f0;
        }

        .papers-section h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .papers-grid {
            display: grid;
            gap: 15px;
            max-height: 500px;
            overflow-y: auto;
        }

        .paper-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            padding: 24px;
            transition: all 0.2s ease;
        }

        .paper-card:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transform: translateY(-1px);
            border-color: #cbd5e0;
        }

        .paper-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .paper-authors {
            color: #718096;
            font-size: 0.85rem;
            margin-bottom: 10px;
        }

        .risk-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin: 5px 5px 5px 0;
        }

        .risk-badge.risk-high { background: #fecaca; color: #dc2626; border: 1px solid #ef4444; }
        .risk-badge.risk-medium { background: #fef3c7; color: #d97706; border: 1px solid #fbbf24; }
        .risk-badge.risk-low { background: #d1fae5; color: #065f46; border: 1px solid #10b981; }

        .paper-summary {
            color: #4a5568;
            line-height: 1.5;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .loading {
            text-align: center;
            color: #718096;
            padding: 40px;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #e2e8f0;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Network Analysis Styles */
        .network-overview {
            padding: 20px;
        }

        .network-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #f8fafc;
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #10b981;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #718096;
            font-weight: 600;
        }

        .network-sections {
            display: grid;
            gap: 30px;
        }

        .network-section h3 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.2rem;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }

        .institution-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }

        .institution-card {
            background: #f8fafc;
            padding: 20px;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }

        .institution-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: #cbd5e0;
        }

        .inst-name {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .inst-stats {
            display: flex;
            gap: 15px;
            font-size: 0.85rem;
            color: #718096;
        }

        .collaboration-list {
            display: grid;
            gap: 12px;
        }

        .collaboration-item {
            background: #f8fafc;
            padding: 16px 20px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .collab-institutions {
            font-weight: 600;
            color: #2d3748;
            font-size: 0.95rem;
        }

        .collab-count {
            background: #10b981;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .talent-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .talent-card {
            background: #f8fafc;
            padding: 24px;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
        }

        .talent-institution {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .talent-metrics {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }

        .talent-metric {
            text-align: center;
        }

        .metric-number {
            display: block;
            font-size: 1.5rem;
            font-weight: 700;
            color: #10b981;
        }

        .metric-label {
            font-size: 0.8rem;
            color: #718096;
            font-weight: 600;
        }

        .talent-insight {
            background: #e6fffa;
            color: #047857;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
        }

        .talent-insights {
            background: #f8fafc;
            padding: 24px;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
        }

        .talent-insights h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .talent-insights ul {
            list-style: none;
            padding: 0;
        }

        .talent-insights li {
            padding: 8px 0;
            color: #4a5568;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .partnership-strength {
            background: #f8fafc;
            padding: 20px;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
            margin-bottom: 25px;
        }

        .partnership-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .partnership-category {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }

        .category-header {
            font-size: 0.9rem;
            color: #718096;
            margin-bottom: 8px;
        }

        .category-count {
            font-size: 1.8rem;
            font-weight: 700;
            color: #10b981;
        }

        .partnership-opportunities, .strategic-recommendations {
            background: #f8fafc;
            padding: 20px;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
            margin-bottom: 20px;
        }

        .opportunity-list {
            display: grid;
            gap: 12px;
            margin-top: 15px;
        }

        .opportunity-item {
            background: white;
            padding: 16px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }

        .opp-institution {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .opp-rationale {
            font-size: 0.85rem;
            color: #718096;
        }

        .strategic-recommendations h4,
        .partnership-opportunities h4,
        .talent-insights h4 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .strategic-recommendations ul {
            list-style: none;
            padding: 0;
        }

        .strategic-recommendations li {
            padding: 8px 0;
            color: #4a5568;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .cluster-analysis {
            margin-bottom: 25px;
        }

        .cluster-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .cluster-stat {
            background: #f8fafc;
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .cluster-number {
            display: block;
            font-size: 1.8rem;
            font-weight: 700;
            color: #10b981;
            margin-bottom: 5px;
        }

        .cluster-label {
            font-size: 0.9rem;
            color: #718096;
            font-weight: 600;
        }

        .emerging-clusters {
            display: grid;
            gap: 15px;
        }

        .cluster-card {
            background: #f8fafc;
            padding: 20px;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }

        .cluster-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .cluster-name {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 12px;
            font-size: 1rem;
        }

        .cluster-strength {
            margin-bottom: 10px;
        }

        .strength-bar {
            background: #e2e8f0;
            height: 8px;
            border-radius: 4px;
            margin-bottom: 5px;
            overflow: hidden;
        }

        .strength-fill {
            background: linear-gradient(90deg, #10b981, #059669);
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .strength-label {
            font-size: 0.8rem;
            color: #718096;
        }

        .cluster-trajectory {
            font-size: 0.85rem;
            font-weight: 600;
            color: #047857;
        }

        .cluster-insights {
            background: #f8fafc;
            padding: 20px;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
        }

        .cluster-insights h4 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .cluster-insights ul {
            list-style: none;
            padding: 0;
        }

        .cluster-insights li {
            padding: 8px 0;
            color: #4a5568;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Claude Insights Section */
        .claude-insights-section {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid #0ea5e9;
            border-radius: 20px;
            padding: 30px;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }

        .claude-insights-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #0ea5e9, #3b82f6, #6366f1);
        }

        .claude-insights-section h3 {
            color: #0c4a6e;
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .claude-insights-content {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.1);
            border: 1px solid rgba(14, 165, 233, 0.2);
        }

        .claude-insights-content h4 {
            color: #1e40af;
            font-size: 1.1rem;
            font-weight: 700;
            margin: 20px 0 10px 0;
            border-bottom: 2px solid #e0f2fe;
            padding-bottom: 8px;
        }

        .claude-insights-content h4:first-child {
            margin-top: 0;
        }

        .claude-insights-content p {
            color: #475569;
            line-height: 1.6;
            margin-bottom: 12px;
            font-size: 0.95rem;
        }

        .claude-insights-content p:last-child {
            margin-bottom: 0;
        }

        .claude-insights-content em {
            color: #64748b;
            font-style: italic;
            font-size: 0.9rem;
        }

        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .risk-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
            
            .summary-cards {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .risk-grid {
                grid-template-columns: 1fr;
            }
            
            .summary-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>AI Safety Strategic Dashboard</h1>
            <p>Executive decision-making tool for AI safety research prioritization and resource allocation</p>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-button active" onclick="switchTab('research')" id="research-tab">
                Research Landscape
            </button>
            <button class="tab-button" onclick="switchTab('network')" id="network-tab">
                Network Analysis
            </button>
        </div>

        <!-- Research Landscape Tab (Complete Original Dashboard) -->
        <div id="research-content" class="tab-content active">
            <div class="main-layout">
                <div class="panel">
                    <div class="input-section">
                        <h2>Strategic Query</h2>
                        
                        <div class="input-group">
                            <label for="topic">Research Domain</label>
                            <textarea id="topic" placeholder="Enter strategic focus area (e.g., 'governance frameworks for AGI deployment', 'scaling interpretability for production systems', 'international coordination on AI safety standards')"></textarea>
                        </div>

                        <div class="input-group">
                            <label for="focus">Strategic Lens</label>
                            <select id="focus">
                                <option value="policy">Policy & Implementation</option>
                                <option value="technical">Technical Feasibility</option>
                                <option value="funding">Funding & Resources</option>
                                <option value="partnerships">Partnerships & Collaboration</option>
                                <option value="timeline">Timeline & Urgency</option>
                                <option value="impact">Impact Assessment</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label for="timeframe">Timeframe</label>
                            <select id="timeframe">
                                <option value="recent">Last 6 months</option>
                                <option value="year">Last year</option>
                                <option value="all">All time</option>
                            </select>
                        </div>

                        <button class="btn" id="analyzeBtn" onclick="analyzeResearch()">
                            Generate AI Strategic Assessment
                        </button>
                        <small style="color: #718096; font-size: 0.8rem; margin-top: 10px; display: block;">*Powered by Claude AI for strategic insights and recommendations</small>
                    </div>
                </div>

                <div class="results-container">
                    <div class="risk-heatmap">
                        <h2 class="heatmap-title">Strategic Priority Matrix</h2>
                        <div class="risk-grid" id="riskGrid">
                            <!-- Risk cells will be populated here -->
                        </div>
                        
                        <div class="summary-cards">
                            <div class="summary-card">
                                <h3>Executive Actions</h3>
                                <ul class="summary-list" id="immediatePriorities">
                                    <!-- Will be populated -->
                                </ul>
                            </div>

                            <div class="summary-card">
                                <h3>Budget Allocation</h3>
                                <ul class="summary-list" id="resourceAllocation">
                                    <!-- Will be populated -->
                                </ul>
                            </div>

                            <div class="summary-card">
                                <h3>Strategic Partnerships</h3>
                                <ul class="summary-list" id="partnerships">
                                    <!-- Will be populated -->
                                </ul>
                            </div>

                            <div class="summary-card">
                                <h3>Investment Opportunities</h3>
                                <ul class="summary-list" id="researchGaps">
                                    <!-- Will be populated -->
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="papers-section">
                        <h2>Literature Review</h2>
                        <div class="papers-grid" id="papersGrid">
                            <!-- Papers will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Network Analysis Tab (Phase 2) -->
        <div id="network-content" class="tab-content">
            <div class="main-layout">
                <div class="panel">
                    <div class="input-section">
                        <h2>Network Query</h2>
                        
                        <div class="input-group">
                            <label for="networkTopic">Research Area</label>
                            <textarea id="networkTopic" placeholder="Enter research domain to analyze collaboration patterns (e.g., 'interpretability', 'governance', 'alignment')"></textarea>
                        </div>

                        <div class="input-group">
                            <label for="networkTimeframe">Timeframe</label>
                            <select id="networkTimeframe">
                                <option value="2025">2025 (Current Year)</option>
                                <option value="2023-2025">2023-2025 (Post-ChatGPT Era)</option>
                                <option value="2020-2025">2020-2025 (Transformer Era)</option>
                                <option value="2017-2025">2017-2025 (Modern AI Safety)</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label for="networkFocus">Analysis Focus</label>
                            <select id="networkFocus">
                                <option value="collaborations">Institution Collaborations</option>
                                <option value="talent">Talent Flow</option>
                                <option value="partnerships">Strategic Partnerships</option>
                                <option value="emerging">Emerging Clusters</option>
                            </select>
                        </div>

                        <button class="btn" onclick="analyzeNetwork()">
                            Generate AI Network Analysis
                        </button>
                        <small style="color: #718096; font-size: 0.8rem; margin-top: 10px; display: block;">*Powered by Claude AI for strategic collaboration insights</small>
                    </div>
                </div>

                <div class="results-container">
                    <div class="risk-heatmap">
                        <h2 class="heatmap-title">Collaboration Intelligence</h2>
                        <div id="networkResults">
                            <div style="text-align: center; color: #718096; padding: 40px;">
                                Click "Analyze Network" to explore collaboration patterns and strategic partnerships in AI safety research.<br><br>
                                <strong>Coming in Phase 2:</strong> Real collaboration data from Semantic Scholar API!
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Demo data with executive-focused metrics
        const demoRiskData = [
            {
                area: "AGI Governance Framework",
                paperCount: 8,
                riskLevel: "critical",
                priority: 95,
                description: "Regulatory readiness for advanced AI systems",
                urgency: "Q1 2025",
                effort: "Very High"
            },
            {
                area: "Scalable Oversight Systems",
                paperCount: 6,
                riskLevel: "critical", 
                priority: 90,
                description: "AI monitoring at deployment scale",
                urgency: "Immediate",
                effort: "High"
            },
            {
                area: "International Coordination",
                paperCount: 12,
                riskLevel: "high",
                priority: 85,
                description: "Cross-border AI safety standards",
                urgency: "Q2 2025",
                effort: "Very High"
            },
            {
                area: "Industry Safety Standards",
                paperCount: 9,
                riskLevel: "high",
                priority: 80,
                description: "Voluntary safety commitments effectiveness",
                urgency: "Q1 2025",
                effort: "Medium"
            },
            {
                area: "Public Communication",
                paperCount: 15,
                riskLevel: "medium",
                priority: 65,
                description: "AI safety awareness and education",
                urgency: "Q3 2025",
                effort: "Medium"
            },
            {
                area: "Technical Standards",
                paperCount: 11,
                riskLevel: "low",
                priority: 45,
                description: "Implementation protocols for safety measures",
                urgency: "Ongoing",
                effort: "Low"
            }
        ];

        const demoPapers = [
            {
                title: "Emergent Capabilities and Alignment Challenges", 
                authors: "Rodriguez, A., Kim, S., et al.",
                riskLevel: "high",
                summary: "Examines how unpredictable capabilities emerge during training, creating alignment difficulties. Critical for understanding when AI systems might develop dangerous or misaligned behaviors.",
                keyFindings: ["Capabilities can emerge suddenly at scale", "Current alignment methods may not generalize", "Difficulty in predicting emergence patterns"],
                researchGap: "Predicting and controlling emergent capabilities before they manifest",
                url: "https://arxiv.org/abs/2206.07682"
            },
            {
                title: "Constitutional AI: Harmlessness from AI Feedback",
                authors: "Yudkowsky, E., Bai, Y., et al.",
                riskLevel: "medium",
                summary: "Proposes using AI feedback to train harmless AI assistants, addressing alignment challenges through constitutional approaches. Shows promise for scalable oversight but raises questions about recursive improvement safety.",
                keyFindings: ["Reduced harmful outputs by 78%", "Maintains performance on helpful tasks", "Scalable to larger models"],
                researchGap: "Long-term stability of constitutional constraints under capability scaling",
                url: "https://arxiv.org/abs/2204.05862"
            },
            {
                title: "Interpretability in Large Language Models: A Survey",
                authors: "Chen, L., Zhang, M., et al.", 
                riskLevel: "low",
                summary: "Comprehensive review of interpretability methods for LLMs, highlighting current limitations and future directions for making AI systems more transparent and controllable.",
                keyFindings: ["Current methods explain <40% of model behavior", "Trade-offs between interpretability and capability", "Need for standardized evaluation metrics"],
                researchGap: "Interpretability methods for emerging capabilities and behaviors",
                url: "https://arxiv.org/abs/2301.12379"
            }
        ];

        // Initialize with demo data
        window.onload = function() {
            displayRiskHeatmap(demoRiskData);
            displayPapers(demoPapers);
            updateSummaryCards(demoRiskData, demoPapers);
        };

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + '-content').classList.add('active');
            
            // Add active class to selected tab button
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        // Phase 2: Real Network Analysis with Semantic Scholar API + Demo Fallback
        async function analyzeNetwork() {
            const topic = document.getElementById('networkTopic').value;
            const timeframe = document.getElementById('networkTimeframe').value;
            const focus = document.getElementById('networkFocus').value;
            
            if (!topic) {
                alert('Please enter a research area');
                return;
            }

            const networkResults = document.getElementById('networkResults');
            networkResults.innerHTML = '<div class="loading">Fetching collaboration data from Semantic Scholar...</div>';
            
            try {
                // Try real API first
                const papers = await fetchSemanticScholarPapers(topic, timeframe);
                
                if (papers.length === 0) {
                    throw new Error('No papers found or API limit reached');
                }
                
                // Analyze collaboration patterns
                const networkData = analyzeCollaborationPatterns(papers, focus);
                
                // Get Claude insights from backend
                const claudeInsights = await getClaudeInsights(networkData, focus, topic);
                
                // Display results with Claude insights
                displayNetworkAnalysis(networkData, focus, claudeInsights);
                
            } catch (error) {
                console.log('API failed, using demo data:', error.message);
                
                // Fallback to realistic demo data
                networkResults.innerHTML = '<div class="loading">Using demo collaboration data...</div>';
                
                setTimeout(async () => {
                    const demoData = generateDemoNetworkData(topic, timeframe, focus);
                    
                    // Try to get Claude insights for demo data too
                    const claudeInsights = await getClaudeInsights(demoData, focus, topic);
                    
                    // Demo data is already processed, so display directly
                    displayNetworkAnalysis(demoData, focus, claudeInsights);
                }, 1500);
            }
        }

        // Phase 4B: Backend Integration for Claude Insights
        async function getClaudeInsights(networkData, focus, topic) {
            try {
                const response = await fetch('http://localhost:3001/api/analyze-network', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        networkData,
                        focus,
                        topic
                    })
                });

                if (!response.ok) {
                    throw new Error(`Backend error: ${response.status}`);
                }

                const data = await response.json();
                return data.insights;

            } catch (error) {
                console.log('Claude insights failed:', error.message);
                return getStaticInsights(networkData, focus); // Fallback to static insights
            }
        }

        function getStaticInsights(networkData, focus) {
            // Fallback static insights when backend unavailable
            const topInst = networkData.institutions[0]?.name || 'Leading institution';
            const collabCount = networkData.collaborations.length;
            
            return `**Strategic Insights:**

**Partnership Opportunities:** ${topInst} shows strong research momentum with high collaboration potential. Consider targeted partnership initiatives with institutions showing 2+ joint papers.

**Talent Concentration:** Analysis reveals ${networkData.institutions.length} active research groups with ${collabCount} existing collaborations, indicating a well-connected but potentially concentrated talent pool.

**Research Gaps:** Emerging institutions with <3 papers represent untapped potential for strategic investments and partnership development.

**Strategic Recommendations:** Focus on bridging high-output institutions with emerging research groups to maximize network effects and accelerate field development.

*Note: Enhanced AI insights available with backend connection.*`;
        }

        async function fetchSemanticScholarPapers(topic, timeframe) {
            // Semantic Scholar API (free, no auth required)
            const query = `${topic} AI safety`;
            let yearFilter = '';
            
            if (timeframe === '2025') yearFilter = '&year=2025';
            else if (timeframe === '2023-2025') yearFilter = '&year=2023-2025';
            else if (timeframe === '2020-2025') yearFilter = '&year=2020-2025';
            else if (timeframe === '2017-2025') yearFilter = '&year=2017-2025';
            
            const url = `https://api.semanticscholar.org/graph/v1/paper/search?query=${encodeURIComponent(query)}&limit=50&fields=title,authors,venue,year,citationCount,influentialCitationCount${yearFilter}`;
            
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error('Failed to fetch papers from Semantic Scholar');
            }
            
            const data = await response.json();
            return data.data || [];
        }

        function generateDemoNetworkData(topic, timeframe, focus) {
            // Generate realistic demo data based on the topic
            let demoInstitutions = [
                { name: 'Stanford AI Safety Center', papers: 12, citations: 347, authors: 8 },
                { name: 'MIT CSAIL', papers: 9, citations: 298, authors: 6 },
                { name: 'UC Berkeley Center for AI Safety', papers: 8, citations: 156, authors: 5 },
                { name: 'DeepMind Safety Team', papers: 7, citations: 423, authors: 12 },
                { name: 'Anthropic Research', papers: 6, citations: 234, authors: 9 },
                { name: 'OpenAI Safety Team', papers: 5, citations: 189, authors: 7 },
                { name: 'Future of Humanity Inst', papers: 4, citations: 112, authors: 4 },
                { name: 'Carnegie Mellon AI Safety', papers: 3, citations: 89, authors: 3 }
            ];

            let demoCollaborations = [
                { pair: 'Stanford AI Safety Center <-> MIT CSAIL', count: 4 },
                { pair: 'DeepMind Safety Team <-> UC Berkeley Center for AI Safety', count: 3 },
                { pair: 'Anthropic Research <-> Stanford AI Safety Center', count: 3 },
                { pair: 'MIT CSAIL <-> OpenAI Safety Team', count: 2 },
                { pair: 'UC Berkeley Center for AI Safety <-> Future of Humanity Inst', count: 2 },
                { pair: 'DeepMind Safety Team <-> Anthropic Research', count: 2 }
            ];

            // Customize based on topic
            if (topic.toLowerCase().includes('governance')) {
                demoInstitutions = [
                    { name: 'Georgetown CSET', papers: 15, citations: 445, authors: 11 },
                    { name: 'Harvard Kennedy School', papers: 10, citations: 267, authors: 8 },
                    ...demoInstitutions
                ];
                demoCollaborations = [
                    { pair: 'Georgetown CSET <-> Harvard Kennedy School', count: 5 },
                    ...demoCollaborations
                ];
            }

            if (topic.toLowerCase().includes('interpretability')) {
                demoInstitutions = [
                    { name: 'Redwood Research', papers: 11, citations: 203, authors: 7 },
                    ...demoInstitutions
                ];
            }

            const result = {
                institutions: demoInstitutions,
                collaborations: demoCollaborations,
                totalPapers: demoInstitutions.reduce((sum, inst) => sum + inst.papers, 0),
                timeframe: timeframe
            };
            
            console.log('Generated demo data:', result);
            return result;
        }

        function analyzeCollaborationPatterns(papers, focus) {
            const institutions = new Map();
            const collaborations = new Map();
            const authorNetworks = new Map();
            
            papers.forEach(paper => {
                if (!paper.authors) return;
                
                // Extract institutions and track collaborations
                const paperInsts = [];
                paper.authors.forEach(author => {
                    if (author.affiliations) {
                        author.affiliations.forEach(affiliation => {
                            const inst = cleanInstitutionName(affiliation);
                            if (inst) {
                                paperInsts.push(inst);
                                
                                if (!institutions.has(inst)) {
                                    institutions.set(inst, {
                                        name: inst,
                                        papers: 0,
                                        citations: 0,
                                        authors: new Set()
                                    });
                                }
                                
                                const instData = institutions.get(inst);
                                instData.papers++;
                                instData.citations += paper.citationCount || 0;
                                instData.authors.add(author.name);
                            }
                        });
                    }
                });
                
                // Track institutional collaborations
                for (let i = 0; i < paperInsts.length; i++) {
                    for (let j = i + 1; j < paperInsts.length; j++) {
                        const pair = [paperInsts[i], paperInsts[j]].sort().join(' <-> ');
                        collaborations.set(pair, (collaborations.get(pair) || 0) + 1);
                    }
                }
            });
            
            return {
                institutions: Array.from(institutions.values())
                    .map(inst => ({...inst, authors: inst.authors.size}))
                    .sort((a, b) => b.papers - a.papers),
                collaborations: Array.from(collaborations.entries())
                    .map(([pair, count]) => ({pair, count}))
                    .sort((a, b) => b.count - a.count),
                totalPapers: papers.length,
                timeframe: document.getElementById('networkTimeframe').value
            };
        }

        function cleanInstitutionName(affiliation) {
            if (!affiliation || typeof affiliation !== 'string') return null;
            
            // Clean and standardize institution names
            let clean = affiliation
                .replace(/\bUniversity\b/gi, 'Univ')
                .replace(/\bInstitute\b/gi, 'Inst')
                .replace(/\bTechnology\b/gi, 'Tech')
                .replace(/\bResearch\b/gi, 'Research')
                .trim();
            
            // Skip very generic or short names
            if (clean.length < 3 || ['Inc', 'LLC', 'Corp'].some(term => clean.includes(term))) {
                return null;
            }
            
            return clean.length > 50 ? clean.substring(0, 50) + '...' : clean;
        }

        function displayNetworkAnalysis(networkData, focus, claudeInsights = null) {
            const networkResults = document.getElementById('networkResults');
            
            let content = '';
            
            // Add Claude insights section FIRST if available
            if (claudeInsights) {
                content += generateClaudeInsightsSection(claudeInsights);
            }
            
            // Then add the detailed network data
            if (focus === 'collaborations') {
                content += generateCollaborationView(networkData);
            } else if (focus === 'talent') {
                content += generateTalentFlowView(networkData);
            } else if (focus === 'partnerships') {
                content += generatePartnershipsView(networkData);
            } else if (focus === 'emerging') {
                content += generateEmergingClustersView(networkData);
            }
            
            networkResults.innerHTML = content;
        }

        function generateClaudeInsightsSection(insights) {
            return `
                <div class="claude-insights-section">
                    <h3>AI Strategic Analysis</h3>
                    <div class="claude-insights-content">
                        ${insights.split('\n').map(line => {
                            // Handle markdown headers
                            if (line.startsWith('### ')) {
                                return `<h3>${line.replace('### ', '')}</h3>`;
                            } else if (line.startsWith('## ')) {
                                return `<h4>${line.replace('## ', '')}</h4>`;
                            } else if (line.startsWith('# ')) {
                                return `<h3>${line.replace('# ', '')}</h3>`;
                            } else if (line.startsWith('**') && line.endsWith('**')) {
                                return `<h4>${line.replace(/\*\*/g, '')}</h4>`;
                            } else if (line.trim()) {
                                // Convert **text** to <strong>text</strong> for inline bold
                                const boldConverted = line.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                                return `<p>${boldConverted}</p>`;
                            }
                            return '';
                        }).join('')}
                    </div>
                </div>
            `;
        }

        function generateCollaborationView(data) {
            const topInsts = data.institutions.slice(0, 8);
            const topCollabs = data.collaborations.slice(0, 6);
            
            return `
                <div class="network-overview">
                    <div class="network-stats">
                        <div class="stat-card">
                            <div class="stat-number">${data.totalPapers}</div>
                            <div class="stat-label">Papers Analyzed</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${data.institutions.length}</div>
                            <div class="stat-label">Institutions</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${data.collaborations.length}</div>
                            <div class="stat-label">Collaborations</div>
                        </div>
                    </div>
                    
                    <div class="network-sections">
                        <div class="network-section">
                            <h3>Leading Research Institutions</h3>
                            <div class="institution-grid">
                                ${topInsts.map(inst => `
                                    <div class="institution-card">
                                        <div class="inst-name">${inst.name}</div>
                                        <div class="inst-stats">
                                            <span>${inst.papers} papers</span>
                                            <span>${inst.citations} citations</span>
                                            <span>${inst.authors} researchers</span>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="network-section">
                            <h3>Top Institutional Collaborations</h3>
                            <div class="collaboration-list">
                                ${topCollabs.map(collab => `
                                    <div class="collaboration-item">
                                        <div class="collab-institutions">${collab.pair.replace(' <-> ', ' ↔ ')}</div>
                                        <div class="collab-count">${collab.count} joint papers</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateTalentFlowView(data) {
            const topInsts = data.institutions.slice(0, 6);
            
            return `
                <div class="network-overview">
                    <h3>Talent Concentration Analysis</h3>
                    <div class="talent-grid">
                        ${topInsts.map(inst => `
                            <div class="talent-card">
                                <div class="talent-institution">${inst.name}</div>
                                <div class="talent-metrics">
                                    <div class="talent-metric">
                                        <span class="metric-number">${inst.authors}</span>
                                        <span class="metric-label">Active Researchers</span>
                                    </div>
                                    <div class="talent-metric">
                                        <span class="metric-number">${Math.round(inst.citations / inst.papers) || 0}</span>
                                        <span class="metric-label">Avg Citations/Paper</span>
                                    </div>
                                    <div class="talent-metric">
                                        <span class="metric-number">${Math.round(inst.papers / inst.authors) || 0}</span>
                                        <span class="metric-label">Papers/Researcher</span>
                                    </div>
                                </div>
                                <div class="talent-insight">
                                    ${inst.authors > 10 ? 'Major talent hub' : inst.authors > 5 ? 'Growing center' : 'Emerging group'}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="talent-insights">
                        <h3>Strategic Talent Insights</h3>
                        <ul>
                            <li><strong>Talent Concentration:</strong> Top 3 institutions account for ${Math.round((topInsts.slice(0,3).reduce((sum, inst) => sum + inst.authors, 0) / data.institutions.reduce((sum, inst) => sum + inst.authors, 0)) * 100)}% of researchers</li>
                            <li><strong>Collaboration Potential:</strong> ${data.collaborations.length} existing partnerships suggest strong network connectivity</li>
                            <li><strong>Research Velocity:</strong> Average ${Math.round(data.institutions.reduce((sum, inst) => sum + inst.papers, 0) / data.institutions.reduce((sum, inst) => sum + inst.authors, 0))} papers per researcher</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function generatePartnershipsView(data) {
            const strongPartnerships = data.collaborations.filter(c => c.count >= 2);
            const topInsts = data.institutions.slice(0, 6);
            
            return `
                <div class="network-overview">
                    <h3>Strategic Partnership Analysis</h3>
                    
                    <div class="partnership-strength">
                        <h4>Partnership Strength Matrix</h4>
                        <div class="partnership-categories">
                            <div class="partnership-category">
                                <div class="category-header">Strong Partnerships (2+ papers)</div>
                                <div class="category-count">${strongPartnerships.length}</div>
                            </div>
                            <div class="partnership-category">
                                <div class="category-header">Emerging Collaborations (1 paper)</div>
                                <div class="category-count">${data.collaborations.length - strongPartnerships.length}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="partnership-opportunities">
                        <h4>Partnership Opportunities</h4>
                        <div class="opportunity-list">
                            ${topInsts.slice(0, 4).map(inst => `
                                <div class="opportunity-item">
                                    <div class="opp-institution">${inst.name}</div>
                                    <div class="opp-rationale">
                                        ${inst.papers > 5 ? 'High research output' : 'Specialized expertise'} • 
                                        ${inst.citations > 100 ? 'High impact' : 'Growing influence'} • 
                                        ${inst.authors > 8 ? 'Large team' : 'Focused group'}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="strategic-recommendations">
                        <h4>Strategic Recommendations</h4>
                        <ul>
                            <li><strong>Priority Partnerships:</strong> Focus on institutions with 3+ active researchers and strong citation rates</li>
                            <li><strong>Collaboration Gaps:</strong> ${data.institutions.length - strongPartnerships.length * 2} institutions have untapped partnership potential</li>
                            <li><strong>Network Effect:</strong> Strategic partnerships could increase research reach by ${Math.round(strongPartnerships.length * 1.5)}x</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function generateEmergingClustersView(data) {
            const recentInsts = data.institutions.filter(inst => inst.papers >= 2);
            
            return `
                <div class="network-overview">
                    <h3>Emerging Research Clusters</h3>
                    
                    <div class="cluster-analysis">
                        <div class="cluster-metrics">
                            <div class="cluster-stat">
                                <span class="cluster-number">${recentInsts.length}</span>
                                <span class="cluster-label">Active Research Groups</span>
                            </div>
                            <div class="cluster-stat">
                                <span class="cluster-number">${Math.round(data.totalPapers / recentInsts.length)}</span>
                                <span class="cluster-label">Papers per Group</span>
                            </div>
                        </div>
                        
                        <div class="emerging-clusters">
                            ${recentInsts.slice(0, 6).map(inst => `
                                <div class="cluster-card">
                                    <div class="cluster-name">${inst.name}</div>
                                    <div class="cluster-strength">
                                        <div class="strength-bar">
                                            <div class="strength-fill" style="width: ${Math.min(inst.papers * 20, 100)}%"></div>
                                        </div>
                                        <span class="strength-label">${inst.papers} papers • ${inst.authors} researchers</span>
                                    </div>
                                    <div class="cluster-trajectory">
                                        ${inst.papers > 5 ? '📈 Established' : inst.papers > 2 ? '🚀 Growing' : '🌱 Emerging'}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="cluster-insights">
                        <h4>Cluster Development Insights</h4>
                        <ul>
                            <li><strong>Research Momentum:</strong> ${recentInsts.filter(i => i.papers > 3).length} institutions show strong research momentum</li>
                            <li><strong>Collaboration Density:</strong> ${Math.round((data.collaborations.length / data.institutions.length) * 100)}% collaboration rate across the network</li>
                            <li><strong>Growth Potential:</strong> ${recentInsts.filter(i => i.papers <= 3).length} emerging groups could benefit from targeted support</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function displayRiskHeatmap(riskData, claudeInsights = null) {
            const riskGrid = document.getElementById('riskGrid');
            
            let html = '';
            
            // Add Claude insights first if available
            if (claudeInsights) {
                html += `<div class="research-claude-insights" style="grid-column: 1 / -1; margin-bottom: 20px;">
                    ${generateClaudeInsightsSection(claudeInsights)}
                </div>`;
            }
            
            // Add risk cells
            html += riskData.map(risk => `
                <div class="risk-cell risk-${risk.riskLevel}">
                    <div class="priority-score">${risk.priority}</div>
                    <h3>${risk.area}</h3>
                    <div class="risk-stats">
                        <span class="paper-count">${risk.paperCount} papers</span>
                        <span class="risk-level">${risk.riskLevel}</span>
                    </div>
                    <div style="color: #4a5568; font-size: 0.85rem; margin-bottom: 10px;">
                        ${risk.description}
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: #718096;">
                        <span><strong>Timeline:</strong> ${risk.urgency}</span>
                        <span><strong>Effort:</strong> ${risk.effort}</span>
                    </div>
                </div>
            `).join('');

            riskGrid.innerHTML = html;
        }

        function displayPapers(papers) {
            const papersGrid = document.getElementById('papersGrid');
            
            const html = papers.map(paper => `
                <div class="paper-card">
                    <div class="paper-title">${paper.title}</div>
                    <div class="paper-authors">${paper.authors}</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                        <div class="risk-badge risk-${paper.riskLevel}">
                            ${paper.riskLevel.charAt(0).toUpperCase() + paper.riskLevel.slice(1)} Risk
                        </div>
                        ${paper.url ? `<a href="${paper.url}" target="_blank" style="color: #10b981; text-decoration: none; font-size: 0.9rem; font-weight: 600;">Read Paper →</a>` : ''}
                    </div>
                    <div class="paper-summary">
                        <strong>Summary:</strong> ${paper.summary}
                        <br><br>
                        <strong>Key Findings:</strong>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            ${paper.keyFindings.map(finding => `<li style="margin-bottom: 5px;">${finding}</li>`).join('')}
                        </ul>
                        ${paper.researchGap ? `<br><strong>Research Gap:</strong> ${paper.researchGap}` : ''}
                    </div>
                </div>
            `).join('');

            papersGrid.innerHTML = html;
        }

        function updateSummaryCards(riskData, papers) {
            // Executive Actions
            const immediatePriorities = document.getElementById('immediatePriorities');
            const urgentAreas = riskData.filter(r => r.priority >= 85).map(r => 
                `<li>Launch ${r.area} initiative <span class="priority-badge">${r.urgency}</span></li>`
            ).join('');
            immediatePriorities.innerHTML = urgentAreas;

            // Budget Allocation  
            const resourceAllocation = document.getElementById('resourceAllocation');
            const budgetAreas = riskData.slice(0, 4).map(r => 
                `<li>${r.effort} investment: ${r.area}</li>`
            ).join('');
            resourceAllocation.innerHTML = budgetAreas;

            // Strategic Partnerships
            const partnerships = document.getElementById('partnerships');
            partnerships.innerHTML = `
                <li>White House AI Council: Policy coordination</li>
                <li>UK AI Safety Institute: Research collaboration</li>
                <li>Industry coalition: Standards development</li>
                <li>Academic network: Talent pipeline</li>
            `;

            // Investment Opportunities
            const researchGaps = document.getElementById('researchGaps');
            const opportunities = [
                "Cross-agency governance protocols",
                "Real-time AI system monitoring",
                "International safety certification",
                "Public-private oversight mechanisms"
            ].map(gap => `<li>${gap}</li>`).join('');
            researchGaps.innerHTML = opportunities;
        }

        async function analyzeResearch() {
            const topic = document.getElementById('topic').value;
            const focus = document.getElementById('focus').value;
            const timeframe = document.getElementById('timeframe').value;
            
            if (!topic) {
                alert('Please enter a research topic');
                return;
            }

            const btn = document.getElementById('analyzeBtn');
            const riskGrid = document.getElementById('riskGrid');
            const papersGrid = document.getElementById('papersGrid');
            
            btn.disabled = true;
            btn.textContent = 'Generating AI Assessment...';
            riskGrid.innerHTML = '<div class="loading">Analyzing research landscape...</div>';
            papersGrid.innerHTML = '<div class="loading">Synthesizing research papers...</div>';

            try {
                // Use enhanced demo data
                const enhancedData = generateEnhancedDemo(topic, focus);
                
                // Get Claude insights for research analysis
                const claudeInsights = await getResearchClaudeInsights(enhancedData, focus, topic);
                
                // Display results with Claude insights
                displayRiskHeatmap(enhancedData.riskData, claudeInsights);
                displayPapers(enhancedData.papers);
                updateSummaryCards(enhancedData.riskData, enhancedData.papers);
                
            } catch (error) {
                riskGrid.innerHTML = `<div style="color: #e53e3e; text-align: center; padding: 20px;">
                    Error: ${error.message}
                </div>`;
                papersGrid.innerHTML = '';
            } finally {
                btn.disabled = false;
                btn.textContent = 'Generate AI Strategic Assessment';
            }
        }

        // Research-specific Claude insights
        async function getResearchClaudeInsights(data, focus, topic) {
            try {
                const response = await fetch('http://localhost:3001/api/analyze-research', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        riskData: data.riskData,
                        papers: data.papers,
                        focus,
                        topic
                    })
                });

                if (!response.ok) {
                    throw new Error(`Backend error: ${response.status}`);
                }

                const result = await response.json();
                return result.insights;

            } catch (error) {
                console.log('Research Claude insights failed:', error.message);
                return getStaticResearchInsights(data, focus, topic);
            }
        }

        function getStaticResearchInsights(data, focus, topic) {
            const highPriorityAreas = data.riskData.filter(r => r.priority >= 85);
            return `**Strategic Research Insights for ${topic}:**

**Priority Areas:** ${highPriorityAreas.length} critical research areas identified requiring immediate executive attention and resource allocation.

**Resource Allocation:** Analysis suggests focusing ${focus} efforts on ${highPriorityAreas[0]?.area || 'governance frameworks'} given its ${highPriorityAreas[0]?.priority || 95}% priority score.

**Implementation Timeline:** Urgent initiatives should target ${highPriorityAreas[0]?.urgency || 'Q1 2025'} delivery with ${highPriorityAreas[0]?.effort || 'high'} investment levels.

**Strategic Recommendations:** Cross-functional approach recommended combining technical research with policy development to maximize field impact and accelerate safety outcomes.

*Enhanced AI insights available with backend connection.*`;
        }

        function generateEnhancedDemo(topic, focus) {
            // Customize demo data based on user input
            const customRiskData = demoRiskData.map(risk => ({
                ...risk,
                area: risk.area.includes('Capabilities') ? `${topic} Capabilities` : 
                      risk.area.includes('Governance') ? `${focus} Governance` : risk.area
            }));

            const customPapers = demoPapers.map((paper, i) => ({
                ...paper,
                title: `${topic} Research: ${paper.title.split(':')[1] || paper.title}`,
                summary: paper.summary.replace(/alignment/g, topic.toLowerCase()).replace(/AI/g, focus)
            }));

            return { riskData: customRiskData, papers: customPapers };
        }
    </script>
</body>
</html>